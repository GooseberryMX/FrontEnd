{% extends 'CVGooseberryBundle::gooseberry_network.html.twig' %}

{% block addMoreCSS %}
    <link rel="stylesheet" href="{{ asset('bundles/cvgooseberry/css/s3.upload.css') }}">
{% endblock %}

{% block bodyHeader %}
    {% include('CVGooseberryBundle:Common:header.html.twig') with { active :'home' } %}
{% endblock %}

{% block bodyContent %}
    <div class="container-fluid content-breather-small" id="breadcrumbs">
        <div class="container">
            <div class="row">
                <div class="col-md-6 col-sm-6">
                    <h4>{% trans %}Edit Profile{% endtrans %}</h4>
                </div><!-- End of column one -->
                <div class="col-md-6 col-sm-6 text-right">
                    <ol class="breadcrumb">
                        <li><a href="{{ path('cv_gooseberry_home', {'network': network.urlname}) }}">{% trans %}Home{% endtrans %}</a></li>
                        <li class="active">{% trans %}Edit Profile{% endtrans %}</li>
                    </ol>
                </div><!-- End of column two -->
            </div><!-- End of row -->
        </div><!-- End of container -->
    </div><!-- End of fluid container -->

    <div class="container">
        <div class="row">

            <!-- investors -->
            <form action="{{ path('cv_gooseberry_edit_profile', {'network': network.urlname}) }}" role="form" name="investorsEditProfileForm" id="investorsEditProfileForm" method="post">
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group input-group">
                            <label for="birthday">{% trans %}Date of birth{% endtrans %}</label>
                            {{ form_widget(form_investors.date_of_birth,{'attr':{'class':'form-control input-lg', 'data-parsley-required':'false', 'placeholder':'mm/dd/yyyy'} }) }}
                        </div>
                        <div class="form-group input-group">
                            <label for="tax-id">{% trans %}Tax ID number{% endtrans %}</label>
                            {{ form_widget(form_investors.tax_id_number,{'attr':{'class':'form-control input-lg', 'data-parsley-required':'false', 'placeholder':'Enter your tax ID'|trans} }) }}
                        </div>
                        {#<div class="form-group input-group">
                            <label for="nationality">{% trans %}Nationality{% endtrans %}</label>
                            {{form_widget(form_investors.nationality,{'attr':{'class':'form-control input-lg', 'required':'true' } }) }}
                        </div>#}
                        <div class="form-group input-group">
                            <label for="address">{% trans %}Address{% endtrans %}</label>
                            {{ form_widget(form_investors.address,{'attr':{'class':'form-control input-lg', 'data-parsley-required':'false', 'placeholder':'Enter your address'|trans} }) }}
                        </div>
                        <div class="form-group input-group">
                            <label for="neighborhood">{% trans %}Neighborhood{% endtrans %}</label>
                            {{ form_widget(form_investors.neighborhood,{'attr':{'class':'form-control input-lg', 'data-parsley-required':'false', 'placeholder':'Enter your neighborhood'|trans} }) }}
                        </div>
                        <div class="form-group input-group">
                            <label for="city">{% trans %}City{% endtrans %}</label>
                            {{ form_widget(form_investors.city,{'attr':{'class':'form-control input-lg', 'data-parsley-required':'true', 'placeholder':'Enter your city'|trans} }) }}
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group input-group">
                            <label for="state">{% trans %}State{% endtrans %}</label>
                            {{ form_widget(form_investors.state,{'attr':{'class':'form-control input-lg', 'data-parsley-required':'false', 'placeholder':'Enter your state'|trans} }) }}
                        </div>
                        <div class="form-group input-group">
                            <label for="country">{% trans %}Country{% endtrans %}</label>
                            {{form_widget(form_investors.country,{'attr':{'class':'form-control input-lg', 'required':'true' } }) }}
                        </div>
                        <div class="form-group input-group">
                            <label for="zip-code">{% trans %}Zip Code{% endtrans %}</label>
                            {{ form_widget(form_investors.zip,{'attr':{'class':'form-control input-lg', 'data-parsley-required':'false', 'placeholder':'Enter zip code'|trans} }) }}
                        </div>
                        <div class="form-group input-group">
                            <label for="phone">{% trans %}Phone Number{% endtrans %}</label>
                            {{ form_widget(form_investors.phone,{'attr':{'class':'form-control input-lg', 'data-parsley-required':'true', 'placeholder':'Enter your phone number'|trans} }) }}
                        </div>
                        {#<div class="form-group input-group">
                            <label for="bank-account">{% trans %}Bank Account Number{% endtrans %}</label>
                            {{ form_widget(form_investors.bank_account_id,{'attr':{'class':'form-control input-lg', 'data-parsley-required':'true', 'placeholder':'Enter your bank account'|trans} }) }}
                        </div>#}
                        <div class="form-group input-group">
                            <label for="file_scan_id_key">{% trans %}Scanned ID{% endtrans %}</label>
                            <span class="fileinput-button upload-signed" id="file_scan_id_keyBox">
                                <button name='upload' class='btn branding-background btn-lg'><i class="icon" data-icon="&#xe009;"></i></button>
                                 <input id="file_scan_id_key" type="file" name="file_scan_id_key" class="s3_upload" signUrl = "{{ path('cv_smartermoney_add_opportunity_signput',{'network':network.urlname, id:'uniqid'}) }}"  data-parsley-required="false" data-parsley-class-handler="#file_scan_id_keyBox" />
                                <div class="upload_status">
                                    <div class="upload_info"><strong class="upload_name"></strong> - <span class="upload_text"></span></div>
                                    <div class="progress_bar"><div class="percent"><span>0%</span></div></div>
                                </div>
                            </span>
                            {{ form_widget(form_investors.file_scan_id) }}
                        </div>
                    </div>
                </div>
                <p class="text-center">
                    {{ form_widget(form_investors.investor_type) }}
                    <input type="submit" id="investorsBtn" class="btn branding-background btn-lg" value="{% trans %}Change profile{% endtrans %}">
                </p>

            </form>

            <!-- fundraisers  -->
            <form action="{{ path('cv_gooseberry_edit_profile', {'network': network.urlname}) }}" role="form" name="fundraisersEditProfileForm" id="fundraisersEditProfileForm" method="post">
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group input-group">
                            <label for="company-legal-name">{% trans %}Legal Name{% endtrans %}</label>
                            {{ form_widget(form_fondraisers.company_name,{'attr':{'class':'form-control input-lg', 'data-parsley-required':'true', 'placeholder':'Enter Legal Name'|trans} }) }}
                        </div>
                        <div class="form-group input-group">
                            <label for="tax-id">{% trans %}Tax ID number{% endtrans %}</label>
                            {{ form_widget(form_fondraisers.tax_id_number,{'attr':{'class':'form-control input-lg', 'data-parsley-required':'true', 'placeholder':'Enter your tax ID'|trans} }) }}
                        </div>
                        {#<div class="form-group input-group">
                            <label for="company-address">{% trans %}Company Address{% endtrans %}</label>
                            {{ form_widget(form_fondraisers.company_address,{'attr':{'class':'form-control input-lg', 'data-parsley-required':'true', 'placeholder':'Enter your Company address'|trans} }) }}
                        </div>#}
                        <div class="form-group input-group">
                            <label for="neighborhood">{% trans %}Neighborhood{% endtrans %}</label>
                            {{ form_widget(form_fondraisers.neighborhood,{'attr':{'class':'form-control input-lg', 'data-parsley-required':'true', 'placeholder':'Enter your neighborhood'|trans} }) }}
                        </div>
                        <div class="form-group input-group">
                            <label for="city">{% trans %}City{% endtrans %}</label>
                            {{ form_widget(form_fondraisers.office_address_city,{'attr':{'class':'form-control input-lg', 'data-parsley-required':'true', 'placeholder':'Enter your city'|trans} }) }}
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group input-group">
                            <label for="state">{% trans %}State{% endtrans %}</label>
                            {{ form_widget(form_fondraisers.state,{'attr':{'class':'form-control input-lg', 'data-parsley-required':'true', 'placeholder':'Enter your state'|trans} }) }}
                        </div>
                        <div class="form-group input-group">
                            <label for="country">{% trans %}Country{% endtrans %}</label>
                            {{form_widget(form_fondraisers.office_address_country,{'attr':{'class':'form-control input-lg', 'required':'true' } }) }}
                        </div>
                        <div class="form-group input-group">
                            <label for="zip-code">{% trans %}Zip Code{% endtrans %}</label>
                            {{ form_widget(form_fondraisers.zip,{'attr':{'class':'form-control input-lg', 'data-parsley-required':'true', 'placeholder':'Enter zip code'|trans} }) }}
                        </div>
                        <div class="form-group input-group">
                            <label for="phone">{% trans %}Phone Number{% endtrans %}</label>
                            {{ form_widget(form_fondraisers.company_phone,{'attr':{'class':'form-control input-lg', 'data-parsley-required':'true', 'placeholder':'Enter your phone number'|trans} }) }}
                        </div>
                    </div>
                </div>
                <p class="text-center">
                    {{ form_widget(form_fondraisers.investor_type) }}
                    <input type="submit" id="fundraisersBtn" class="btn branding-background btn-lg" value="Change profile"|trans>
                </p>
            </form>
        </div>
    </div><!-- End of container -->

{% endblock %}

{% block addMoreJS %}
    <script src="{{ asset('bundles/cvgooseberry/js/s3.upload.js') }}"></script>
    <script src="{{ asset('bundles/cvgooseberry/js/bootstrap/bootstrap.js') }}"></script>
    <script src="{{ asset('bundles/cvgooseberry/js/css3-animate-it.js') }}"></script>
    <script src="{{ asset('bundles/cvgooseberry/js/bootstrap-hover-dropdown.js') }}"></script>
    <script src="{{ asset('bundles/cvgooseberry/js/modernizr.js') }}"></script>
    <script src="{{ asset('bundles/cvgooseberry/js/Slickform.js') }}"></script>
    <!-- Google maps api -->
    <script src="http://maps.google.com/maps/api/js?sensor=false&libraries=geometry&v=3.7"></script>
    <script src="{{ asset('bundles/cvgooseberry/js/maps.js') }}"></script>
    <script src="{{ asset('bundles/cvgooseberry/js/scripts.js') }}"></script>
    <script type="text/javascript">
        $(function() {
            $( "#investor_form_date_of_birth" ).datepicker();
            $('#completeRegistrationTabs li a').click( function(){
                $(this).blur();
            });
            var typeAccount = '{{ profile.investor_type|default(0) }}',
                scan_id_name, scan_id_link;

            if(typeAccount === 'INVESTOR'){
                $('#fundraisersEditProfileForm').hide();
                $('#investorsEditProfileForm').show();
                scan_id_name = '{{ profile['file_scan_id']['name']|default() }}';
                scan_id_link = '{{ profile['file_scan_id']['s3_url']|default() }}';
                if(scan_id_name && scan_id_link && scan_id_name.length > 0 && scan_id_link.length > 0){
                    $('#investor_form_file_scan_id').val('{"name":"' + scan_id_name + '","s3_url":"' + scan_id_link.match(/\/\/.*\/(.*\/.*\/.*)\?.*/)[1] + '"}');
                    $('.upload_status').show().find('.percent').attr({'style':'width:100%;'}).find('span').html('100%').closest('.progress_bar').addClass('loading').prev('.upload_info').find('strong.upload_name').html(scan_id_name).next('span.upload_text').html('Already exists.');
                    $('#file_scan_id_key').attr('data-parsley-required', false);
                }

            } else {
                $('#fundraisersEditProfileForm').show();
                $('#investorsEditProfileForm').hide();
            }
            $("#investorsBtn, #fundraisersBtn").click(function (e) {
                var isSubmit = true;
                if($(this).attr('id') === 'investorsBtn'){
                    $('#investor_form_investor_type').val('INVESTOR');
                    $('#fundraiser_form_investor_type').val('');

                } else {
                    $('#investor_form_investor_type').val('');
                    $('#fundraiser_form_investor_type').val('FUNDRAISER');
                }

                /* Validation */
                if($('#file_scan_id_key').attr('filename') != undefined){
                    $('#investor_form_file_scan_id').val('{"name":"' + $('#file_scan_id_key').attr('filename') + '","s3_url":"' + $('#file_scan_id_key').attr('s3_url').match(/\/\/.*\/(.*\/.*\/.*)\?.*/)[1] + '"}');
                }

            });
        });
    </script>
{% endblock %}